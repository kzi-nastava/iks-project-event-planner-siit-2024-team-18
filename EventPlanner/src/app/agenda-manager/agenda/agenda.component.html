<div class="agenda" *ngIf="event">
    <div class="header-container">
        <h2>
            Event: <span class="highlight">{{ event.name }}</span>
        </h2>
    </div>

    <div class="input-data">
        <form [formGroup]="agendaForm" class="agenda-form">
            <div class="form-row">
                <mat-form-field>
                    <mat-label>Name</mat-label>
                    <input matInput required formControlName="name" />
                    <mat-error
                        *ngIf="
                            agendaForm.get('name')?.invalid &&
                            agendaForm.get('name')?.touched
                        "
                    >
                        Please enter name.
                    </mat-error>
                </mat-form-field>

                <mat-form-field>
                    <mat-label>Location</mat-label>
                    <input matInput required formControlName="location" />
                    <mat-error
                        *ngIf="
                            agendaForm.get('location')?.invalid &&
                            agendaForm.get('location')?.touched
                        "
                    >
                        Please enter location.
                    </mat-error>
                </mat-form-field>
            </div>

            <div class="form-row">
                <mat-form-field class="full-width">
                    <mat-label>Description</mat-label>
                    <input matInput required formControlName="description" />
                    <mat-error
                        *ngIf="
                            agendaForm.get('description')?.invalid &&
                            agendaForm.get('description')?.touched
                        "
                    >
                        Please enter description.
                    </mat-error>
                </mat-form-field>
            </div>

            <div class="form-row">
                <mat-form-field appearance="fill">
                    <mat-label>Start Date</mat-label>
                    <input
                        matInput
                        [matDatepicker]="startDatePicker"
                        formControlName="startDate"
                        readonly
                    />
                    <mat-datepicker-toggle
                        matSuffix
                        [for]="startDatePicker"
                        [disabled]="true"
                    ></mat-datepicker-toggle>
                    <mat-datepicker #startDatePicker></mat-datepicker>
                </mat-form-field>

                <mat-form-field appearance="fill">
                    <mat-label>Start Time</mat-label>
                    <input
                        matInput
                        formControlName="startTime"
                        readonly
                    />
                    <ngx-mat-timepicker-toggle
                        matSuffix
                        [disabled]="true"
                    ></ngx-mat-timepicker-toggle>
                </mat-form-field>
            </div>

            <div class="form-row">
                <mat-form-field appearance="fill">
                    <mat-label>End Date</mat-label>
                    <input
                        matInput
                        [matDatepicker]="endDatePicker"
                        formControlName="endDate"
                        required
                    />
                    <mat-datepicker-toggle
                        matSuffix
                        [for]="endDatePicker"
                    ></mat-datepicker-toggle>
                    <mat-datepicker #endDatePicker></mat-datepicker>

                    <mat-error
                        *ngIf="
                            agendaForm.get('endDate')?.hasError('required') &&
                            agendaForm.get('endDate')?.touched
                        "
                    >
                        Please enter end date.
                    </mat-error>
                </mat-form-field>

                <mat-form-field appearance="fill">
                    <mat-label>End Time</mat-label>
                    <input
                        matInput
                        [ngxMatTimepicker]="endTimePicker"
                        formControlName="endTime"
                        required
                    />
                    <ngx-mat-timepicker-toggle
                        matSuffix
                        [for]="endTimePicker"
                    ></ngx-mat-timepicker-toggle>
                    <ngx-mat-timepicker #endTimePicker></ngx-mat-timepicker>

                    <mat-error
                        *ngIf="
                            agendaForm.get('endTime')?.hasError('required') &&
                            agendaForm.get('endTime')?.touched
                        "
                    >
                        Please enter end time.
                    </mat-error>
                </mat-form-field>
            </div>
            <div class="form-row">
                <mat-error
                    *ngIf="agendaForm.errors?.['endBeforeStart'] && (agendaForm.get('endDate')?.touched || agendaForm.get('endTime')?.touched)"
                >
                    End date time must be after start date time.
                </mat-error>
            </div>
        </form>

        <button class="create" (click)="addActivity()">
            <mat-icon class="custom-add-icon"></mat-icon>
        </button>
    </div>

    <div class="item-list-container">
        <mat-list>
            <mat-list-item *ngFor="let activity of activities">
                <div class="item">
                    <div class="item-content">
                        <div><strong>Name:</strong> {{ activity.name }}</div>
                        <div>
                            <strong>Description:</strong>
                            {{ activity.description }}
                        </div>
                        <div>
                            <strong>Start:</strong> {{ activity.startDate | date : "short" }}
                        </div>
                        <div><strong>End:</strong> {{ activity.endDate | date : "short" }}</div>
                        <div>
                            <strong>Location:</strong> {{ activity.location }}
                        </div>
                    </div>

                    <div class="item-buttons">
                        <button class="edit" (click)="editActivity(activity)">
                            <mat-icon class="custom-edit-icon"></mat-icon>
                        </button>
                    </div>
                </div>
            </mat-list-item>
        </mat-list>
    </div>
</div>
